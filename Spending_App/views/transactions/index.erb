
  <h3>All Transactions</h3>


<section class='tr-table'>



<section>

<filters class='filter'>
<% for transaction in @filtered %>
<form action='/transactions/filtered/<%= transaction.tag_id%>' method='GET'>
  <input type='submit' value='Filter By <%=transaction.tag().type() %>'>
</form>
<% end %>
</filters>



</section>

<section>
<table>
  <tr>
    <th>Tag</th>
    <th>Merchant</th>
    <th>
      Transaction Date
      <form action='/transactions/sorted' method='GET'>
        <input type='submit' value='Sort Descending'>
      </form>
    </th>
    <th>Amount</th>
    <th>Budget left</th>
  <% for transaction in @transactions %>
  <tr>
    <td><%= transaction.tag().type() %></td>
    <td><%= transaction.merchant().name() %></td>
    <td><%= transaction.tr_date() %>
    </td>
    <td><%= transaction.amount() %></td>
    <td <% if transaction.get_budget.budget() - transaction.get_budget.spent() < 0 %>
      style='color: #cf4848;'
      <% else %>
      style='color: #465251;' <% end %>>

<%= transaction.get_budget.budget() - transaction.get_budget.spent() %></td>
    <td><form action='/transactions/<%= transaction.id %>' method='GET'>
    <input type='submit' value='View Transaction'>
    </form></td>
  </tr>
  <% end %>
  <tr>
    <td colspan='5' style='text-align: right;'>
    <% total = 0 %>
    <% for transaction in @transactions %>
    <%total += transaction.amount() %>
    <% end %>
    Total: <%=total %>
    </td>
  </tr>
  <tr>
    <td colspan="5" style='text-align: center;'>Total of all transactions: <%= Transaction.sum()%></td>
  </tr>

</table>



  <article class='alert'>
    <% for budget in @budgets %>
        <% if (budget.budget() > 0 && budget.budget() <= 30) %>
        ONLY Â£ <%=budget %> left for <%=budget.tag().type()%>!<br />
        <% elsif (budget.budget() == 0) %>
        Budget reached for <%=budget.tag().type()%>!<br />
        <% elsif (budget.budget() < 0) %>
        Over budget for <%=budget.tag().type()%>!<br />
        <% end %>

<% end %>
</article>









</section>
</section>
